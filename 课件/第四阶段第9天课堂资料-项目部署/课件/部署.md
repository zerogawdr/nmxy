# 单页应用程序部署 {ignore=true}

# 前后端分离的几种模式

- 静态服务器（提供js、css、图片、静态页面）
- 数据服务器（提供数据访问的api，java、php、c#）

## 情况1

静态服务器上的内容全部由前端开发者完成（html+css+jquery、webpack+vue）

静态服务器和数据服务器分离

数据服务器，完全由后端开发者完成（API文档），mockjs(模拟数据，拦截请求)

小型项目、微型项目

涉及到跨域的问题，进一步导致安全问题，跨域时，数据服务器要处理跨域和访问权限

## 情况2

静态服务器上的内容全部由前端开发者完成（html+css+jquery、webpack+vue）

数据服务器，完全由后端开发者完成（API文档），mockjs(模拟数据，拦截请求)

部署，将数据服务器和静态服务器合并部署

大多数中小型项目

不会遇到跨域问题

## 情况3

静态服务器上的内容全部由前端开发者完成（html+css+jquery、webpack+vue）

数据服务器，完全由后端开发者完成（API文档），mockjs(模拟数据，拦截请求)

前端服务器：充当静态服务器功能，同时充当API请求转发的功能

访问index.html:

浏览器 -> 前端服务器（返回index.html） -> 浏览器 ---其他静态资源---> 前端服务器（返回静态资源）

---> 浏览器（遇到了数据） --> 前端服务器 --转发请求--> 数据服务器（响应数据） --> 前端服务器 --> 浏览器

1. 没有跨域（浏览器的同源策略）
2. 浏览器不知晓数据服务器
3. 前端服务器可以对请求拥有更多的控制权力


# 工程的打包

1. 运行```npm run build```打包部署文件夹
2. 移动到express的静态资源目录
3. 使用```connect-history-api-fallback```将所有页面请求映射到index.html页面

官网地址：https://www.npmjs.com/package/connect-history-api-fallback

4. 配置```rewrite```可以解决网页无法访问api的问题

# 服务器准备

1. 购买域名并完成备案
2. 购买服务器（阿里云、腾讯云、亚马逊等供应商）
3. 安装服务器操作系统（宝塔Linux管理面板）(Linux)
4. 配置域名解析，将域名指向你的服务器IP地址
5. 本地安装PuTTY，用于远程管理服务器
6. 服务器端安装node、npm、pm2（可使用宝塔管理面板安装）

# 完成服务端部署

1. 将本地打包的工程上传至服务器相应的目录
2. 在服务器中使用pm2启动（或重启）


